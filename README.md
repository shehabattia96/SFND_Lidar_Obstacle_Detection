# Sensor Fusion Self-Driving Car Course

This is an online Udacity course project. I implement my own RANSAC, KD-Tree and KD Clustering algorithms, after using PCL's culstering algorithms first.

## Filesystem

- .vscode/*
  - I kept the VS Code config dir checked into the repo because it contains some build and debug configs for the Microsoft C/C++ extension.
- media/*
  - Contains screenshots from the project
- src/*
  - contains the source code.
    - [src\environment.cpp](src\environment.cpp)
      - the main file used to load three environments
    - [src\processPointClouds.cpp](src\processPointClouds.cpp)
      - functions to perform RANSAC, KD-TREE and KD Clustering
- src/sensors
  - contains sample LIDAR data
- src/quiz
  - building block code for RANSAC and KD-Tree algorithms
- src/render
  - helper functions to display the scenes using Point Cloud Library (PCL)

## Getting started

### dependencies

- PCL, BOOST, FLANN (via vcpkg)
- cmake 3.16.2
- MSVC 14.21's compiler (but any other c/cpp compiler should also work)

### how to run

#### via debugger

The debugger shortcut for VS Code is F5. By default, the environment is set to `cityBlockStreamEnv` in main().

#### via CLI

The first argument is the environemnt. Running `Environment simpleHighway|cityBlockFile|cityBlockStream` will load the app in the respective environment.

### Building environment on win32/64 using vcpkg and VSCode

- get a complier. This is a list of VSCode supported ones [https://marketplace.visualstudio.com/items?itemName=ms-vscode.cpptools](https://marketplace.visualstudio.com/items?itemName=ms-vscode.cpptools)
  - I used msvc and followed this guide [https://code.visualstudio.com/docs/cpp/config-msvc](https://code.visualstudio.com/docs/cpp/config-msvc)
- get [https://github.com/microsoft/vcpkg](https://github.com/microsoft/vcpkg)
  - `vcpkg install pcl` and `vcpkg install boost`. Add the :x64-windows flag if needed (e.g. `vcpkg install pcl:x64-windows`). For some reason, all of boost doesn't come with PCL install command.
  - Also run `vcpkg install integrate` to build the toolset file.
- build project using "CMAKE Gui".
  - get cmake gui [https://cmake.org/runningcmake/](https://cmake.org/runningcmake/)
  - Choose the "Specify toolchain file for compiling" option and give it the toolset file generated by `vcpkg install integrate` in "${vcpkgRoot}/scripts/buildsystems/vcpkg.cmake"
    - Reference [https://developerpaul123.github.io/c++/cmake/using-vcpkg-on-windows/](https://developerpaul123.github.io/c++/cmake/using-vcpkg-on-windows/)
  - run `cmake --build .` inside the build dir
- set up VSCode:
  - get Microsoft's C/C++ extension.
  - Command Palette: C/C++: Edit Configurations (UI)
    - be sure the vcpkg directory is included `${vcpkgRoot}/installed/x64-windows/include`
    - add `cmake --build .` to tasks.json
    - add `${workspaceFolder}/build/Debug/environment.exe` to launch.json for easy debugging
- shortcuts:
  - `ctrl + shift + b` to build
  - `F5` to debug

### troubleshooting

- For my machine, I had to choose x64 in CMake Gui to get the dependencies to be discovered properly (even though I had x86 dependencies installed as well).
- I noticed that on first run after building, I got an error `error while loading shared libraries: pcl_common_debug.dll: cannot open shared object file: No such file or directory` but the problem was actually a missing DLL file `build\Debug\libpng16.dll`. I cloned and renamed `libpng16d.dll` to `libpng16.dll` and the program worked.

## Project references

- PCL RANSAC tutorial [http://pointclouds.org/documentation/tutorials/extract_indices.php#extract-indices](http://pointclouds.org/documentation/tutorials/extract_indices.php#extract-indices) - was helpful in defining the segmentation algorithm to retrieve important indicies, then filtering those indecies to extract useful point clouds.
- PCL KD Clustering tutorial [http://www.pointclouds.org/documentation/tutorials/cluster_extraction.php](http://www.pointclouds.org/documentation/tutorials/cluster_extraction.php) - was helpful in separating entities in the scene

## Notes from working on this project

- not using `typename` with boost ptr didn't cause a complier error
- experimental std::experimental::filesystem was useful for dynamically building filepaths to local files.

### Original repo

check out the original readme at [https://github.com/udacity/SFND_Lidar_Obstacle_Detection/blob/master/README.md](https://github.com/udacity/SFND_Lidar_Obstacle_Detection/blob/master/README.md)
